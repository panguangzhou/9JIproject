"use strict";$(function(){var t=Cookie.get("goodslist");t=""===t?[]:JSON.parse(t);var e=document.querySelector(".cart-buy"),n=document.createElement("li");n.innerHTML=t.map(function(t){return'\n\t\t\t<p class="good_check"><input type="checkbox" name="good" id="" value=""/></p>\n\t\t\t<p class="good_img"><img src="'+t.imgurl+'" alt="" style="width:40px;height: 40px;"/></p>\n\t\t\t<p class="good_name">'+t.title+'</p>\n\t\t\t<p class="good_price">'+t.price+'</p>\n\t\t\t<p class="num">\n\t\t\t<span class="cutnum">-</span>\n\t\t\t<input class="nownum" type="text" value="1" />\n\t\t\t<span class="addnum">+</span>\n\t\t\t</p>\n\t\t\t<p class="good_total">'+t.price+'</p>\n\t\t\t<p class="good_del">\n\t\t\t<a href="javascript:;">删除</a>\n\t\t\t</p>\n\t\t\t'}).join(""),e.appendChild(n);var c=[200,304],o=new XMLHttpRequest;o.onload=function(){if(0<=c.indexOf(o.status)){var t=JSON.parse(o.responseText);document.querySelector(".news").innerHTML=t.map(function(t){return'<a href="javascript:;">\n\t\t\t\t\t\t\t<img src="../'+t.imgurl+'" />\n\t\t\t\t\t\t\t<p>'+t.title+"</p>\n\t\t\t\t\t\t\t<span>"+t.price+"</span>\n\t\t\t\t\t\t\t</>"}).join("")}},o.open("get","../api/list-2.php"),o.send(),$(".cart-buy").on("click",".addnum",function(){var t=$(this).prev().val();100===++t&&(t=100),$(this).prev().val(t),a($(this));var e=i();l(e),p(e)}),$(".cart-buy").on("click",".cutnum",function(){var t=$(this).next().val();--t<1&&(t=1),$(this).next().val(t),a($(this));var e=i();l(e),p(e)}),$(".cart-buy").on("click",".good_del",function(){$(this).parent().remove(),0===$(".good_del").size()&&$("#del").remove();var t=i();l(t),p(t)});var r=!0;function a(t){var e=t.parent().prev().text();e=(e=$.trim(e)).substring(2);var n=t.parent().find(".nownum").val()*parseInt(e);t.parent().next().html("￥&nbsp;"+n.toFixed(2))}function i(){for(var t=[],e=$(".good_check input").size(),n=0;n<e;n++)$(".good_check input").eq(n).prop("checked")&&t.push(n);return t}function p(t){for(var e=0,n=0;n<t.length;n++)e+=parseInt($(".nownum").eq(t[n]).val());$("#allnum").html("已选"+e+"件商品")}function l(t){for(var e=0,n=0;n<t.length;n++){var c=$(".good_total").eq(t[n]).text();c=(c=$.trim(c)).substring(2),e+=parseInt(c)}$("#numprice").html("总计（不含运费）：￥"+e.toFixed(2))}$("#allchecked").on("click",function(){r?($("#allchecked input").prop("checked","checked"),$(".good_check input").prop("checked","checked")):($("#allchecked input").removeAttr("checked"),$(".good_check input").removeAttr("checked")),r=!r,i();var t=i();l(t),p(t)}),$("#delall").on("click",function(){for(var t=i(),e=t.length;0<=e;e--)$(".good_check").eq(t[e]).parent().remove();0===$(".good_del").size()&&$("#del").remove()}),$(".cart-buy").on("click",".good_check",function(){var t=i();t.length===$(".good_check input").size()?$("#allchecked input").prop("checked","checked"):$("#allchecked input").removeAttr("checked"),p(t),l(t)})});